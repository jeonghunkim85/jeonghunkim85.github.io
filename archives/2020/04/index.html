
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Deliwind">
    <title>Archives: 2020/4 - Deliwind</title>
    <link rel="canonical" href="https://blog2.deliwind.com/archives/2020/04/">
    <meta name="author" content="shockshot@naver.com">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{}</script>
    <meta property="og:type" content="blog">
<meta property="og:title" content="Deliwind">
<meta property="og:url" content="https://blog2.deliwind.com/archives/2020/04/index.html">
<meta property="og:site_name" content="Deliwind">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="shockshot@naver.com">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-kvpycffeiaxsbgvbkdhwiqlinu750trh6s9bqthsefrjo7rf1q2lj1oqxj7d.min.css">

    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-159338205-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-159338205-1');
    </script>


    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/%20" aria-label>
            Deliwind
        </a>
    </div>
    
        
            <a class="header-right-picture " href="#about" aria-label="Open the link: /#about">
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/" rel="noopener" title="Home">
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" rel="noopener" title="Categories">
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" rel="noopener" title="Tags">
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-archives" rel="noopener" title="Archives">
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link open-algolia-search" href="#search" rel="noopener" title="Search">
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" rel="noopener" title="About">
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/jeonghunkim85" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="mailto:shockshot@naver.com" target="_blank" rel="external nofollow noopener noreferrer" title="Mail">
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://blog.deliwind.com" target="_blank" rel="noopener" title="Another blog">
                        <i class="sidebar-button-icon fa fa-blog" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Another blog</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2" class="
                        hasCoverMetaIn
                        ">
                
    <section class="postShorten-group main-content-wrap">
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/20200430/Java-%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90/" aria-label=": Java 정규표현식을 사용할 때 주의할 점">
                            Java 정규표현식을 사용할 때 주의할 점
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-04-30T00:00:00+09:00">
	
		    Apr 30, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Java/">Java</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>사실 이 이야기는 <code>Effective Java 6장 - 불필요한 객체 생성을 피하라</code> 에 나오는 아주 기초적인 이야기 이다. 그러나 습관이 되지 않아 생각없이 개발하다보면 어느새 이 규칙을 어겨서 어김없이 리팩토링 대상이 되곤 하는데다가, 막상 개발하면서 쓰려다 보면 사용 방법이 잘 생각나지 않아 메모할 겸 짧은 글을 작성 해본다.<br><del>(요즘 좀 정신이 나가 있어서 공부는 꾸준히 하기는 한다만, 공부하는 양은 좀 줄었고, 진도는 좀처럼 나가지가 않는다. 에라이)</del></p>
<p>일반적으로 Java에서 흔히 사용할 수 있는 정규 표현식의 예를 보자. (Junit5)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasOnlyNumbers</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.matches(<span class="string">&quot;[\\d]*&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@DisplayName(&quot;Utils 테스트&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UtilsTest</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@DisplayName(&quot;숫자 외의 문자가 있을 경우 false를 return 해야 한다&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">should_return_false_when_has_other_characters</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String numbersWithCharacter = <span class="string">&quot;1a2s3d4f5g6&quot;</span>;</span><br><span class="line">    <span class="keyword">boolean</span> expected = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> result = Utils.hasOnlyNumbers(numbersWithCharacter);</span><br><span class="line"></span><br><span class="line">    assertEquals(expected, result);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@DisplayName(&quot;숫자외의 문자가 없을 경우 true를 return 해야 한다&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">should_return_true_when_has_only_numbers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String numbersWithCharacter = <span class="string">&quot;123456789&quot;</span>;</span><br><span class="line">    <span class="keyword">boolean</span> expected = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">boolean</span> result = Utils.hasOnlyNumbers(numbersWithCharacter);</span><br><span class="line"></span><br><span class="line">    assertEquals(expected, result);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/20200430/Java-%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90/image1.png" class title="테스트결과1">

<p>오케이, 원하는 바를 손쉽게 얻었다. 그러나 지금 얻은 결과는 성능상 좋지 못하다. 사실 일반적인 상황에서 String의 matches 메소드를 사용하는게 엄청나게 성능에 문제를 주는 경우는 별로 없으나, 습관이 중요한데다가, 실제로 이런 코드들이 쌓여 문제를 발생하는 경우도 있으니 좋은 습관을 들이는 게 좋다.<br>이펙티브 자바는 String.matches를 사용하는 것보다 더 <del>고급지고</del>어렵고 성능이 좋은 방법을 알고 있다.</p>
<h2 id="Pattern-클래스를-사용해-보자"><a href="#Pattern-클래스를-사용해-보자" class="headerlink" title="Pattern 클래스를 사용해 보자"></a>Pattern 클래스를 사용해 보자</h2><p>바로 Pattern클래스를 사용해 같은 일을 더 성능 좋게 사용할 수 있다.<br>사실 위 예제의 코드는 메소드가 실행 될때마다 내부적으로 Pattern 인스턴스를 만들고 사용 후 버리는 작업을 수행하게 되는데, 이 Pattern을 final static 객체로 미리 선언해두고 사용하게 되면 메소드가 호출될 때마다 새로 생성하고 버리는 작업이 없어지게 된다.<br>아래 코드를 보자</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Pattern ONLY_NUMBERS_PATTERN = Pattern.compile(<span class="string">&quot;[\\d]*&quot;</span>);</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasOnlyNumbers</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ONLY_NUMBERS_PATTERN.matcher(s).matches();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/20200430/Java-%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90/image2.png" class title="테스트결과2">

<p>테스트를 잘 통과하는 것을 볼 수 있다. 자, 그럼 얼마만큼의 성능 차이가 날까? </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DisplayName(&quot;Utils 테스트&quot;)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UtilsTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="keyword">int</span> times = <span class="number">10000000</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@DisplayName(&quot;리팩토링 후&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">test_refactor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String numbersWithCharacter = <span class="string">&quot;1a2s3d4f5g6&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>  i=<span class="number">0</span>; i &lt; times; i++)&#123;</span><br><span class="line">      Utils.hasOnlyNumbersRefactor(numbersWithCharacter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Test</span></span><br><span class="line">  <span class="meta">@DisplayName(&quot;리팩토링 전&quot;)</span></span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">test_before_refactor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> String numbersWithCharacter = <span class="string">&quot;1a2s3d4f5g6&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span>  i=<span class="number">0</span>; i &lt; times; i++)&#123;</span><br><span class="line">      Utils.hasOnlyNumbersOriginal(numbersWithCharacter);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>컴퓨팅 성능마다, JVM 셋팅마다 다르겠지만, 메소드 수행을 1000만회 진행 했을때 꽤나 차이가 나는 것을 눈으로 볼 수 있었다.<br>(2.35초 -&gt; 0.83초)</p>
<img src="/20200430/Java-%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90/image3.png" class title="테스트결과3">

<p>이펙티브 자바의 아이템6 에는 이 외에도 다른 팁들도 있으나 일단 오늘은 정규 표현식 부분만 정리했다.</p>
<p>정규 표현식을 사용할때는 기억하자.</p>
<blockquote>
<ol>
<li>static final Pattern 으로 불변객체를 생성해서 사용하자</li>
<li>Pattern p = Pattern.compile(“정규식”);</li>
<li>p.matcher(string).matches();</li>
</ol>
</blockquote>
<h2 id="끗"><a href="#끗" class="headerlink" title="끗"></a>끗</h2>
                    
                        


                    
                    
                        <p>
                            <a href="/20200430/Java-%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%A0-%EB%95%8C-%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/20200411/ConfigurationProperties-%EC%82%AC%EC%9A%A9%EB%B0%A9%EB%B2%95/" aria-label=": @ConfigurationProperties 사용방법">
                            @ConfigurationProperties 사용방법
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-04-11T00:00:00+09:00">
	
		    Apr 11, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Java/">Java</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <p>Spring boot 에서는 application.yml (또는 application.properties) 파일의 내용을 빈의 변수에 바인딩하도록 도와주는 어노테이션이 있다.<br><code>@Value(&quot;$&#123;property.value&#125;&quot;)</code> 뭐 이런식으로 사용하는데 변수가 늘어남에 따라 어노테이션이 많아져서 가독성을 해치는 경우가 있고, 일일히 지정해주기가 귀찮을 경우 쓸 수 있는 방법인 <code>@ConfigurationProperties</code> 어노테이션에 대해서 간단히 적어 보려 한다.</p>
<h2 id="사용방법"><a href="#사용방법" class="headerlink" title="사용방법"></a>사용방법</h2><p><code>@ConfigurationProperties</code> 는 클래스에 선언하는 어노테이션이다.<br>간단히 아래 예시와 같이 사용한다.</p>
<p>먼저 gradle(또는 maven 빌드 툴)에 아래 dependency를 설정한다.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">annotationProcessor <span class="string">&#x27;org.springframework.boot:spring-boot-configuration-processor&#x27;</span></span><br></pre></td></tr></table></figure>

<p>yml에 필요한 값들을 설정하고</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user:</span></span><br><span class="line">  <span class="attr">conf:</span></span><br><span class="line">    <span class="attr">property1:</span> <span class="string">&quot;value1&quot;</span></span><br><span class="line">    <span class="attr">property2:</span> <span class="string">&quot;value2&quot;</span></span><br></pre></td></tr></table></figure>

<p>값들을 사용하고자 하는 클래스에 <code>@ConfigurationProperties</code> 어노테이션을 추가한다. 여기서 prefix도 설정할 수 있다. (user.conf는 예시를 위해 작성해 놓은 것이고, prefix는 다른 값으로도 사용할 수 있다.)<br>주의할 점은 <code>@Value</code> 어노테이션을 활용해 값을 바인딩 하는것과 다르게, 반드시 setter 메소드를 필요로 한다.<br><code>@ConfigurationProperties</code>는 setter 메소드를 사용해 설정값을 바인딩 하기 때문이다. 여기서는 클래스에 <code>@Setter</code> 롬복 어노테이션을 사용해 한번에 정의했다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Setter</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;user.conf&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String property1;</span><br><span class="line">  <span class="keyword">private</span> String property2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="끗"><a href="#끗" class="headerlink" title="끗"></a>끗</h2>
                    
                        


                    
                    
                        <p>
                            <a href="/20200411/ConfigurationProperties-%EC%82%AC%EC%9A%A9%EB%B0%A9%EB%B2%95/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    
    <article class="postShorten postShorten--thumbnailimg-bottom">
        <div class="postShorten-wrap">
            
            <div class="postShorten-header">
                <h1 class="postShorten-title">
                    
                        <a class="link-unstyled" href="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/" aria-label=": IntelliJ에서 `.http`로 테스트 하기">
                            IntelliJ에서 `.http`로 테스트 하기
                        </a>
                    
                </h1>
                <div class="postShorten-meta">
    <time datetime="2020-04-05T00:00:00+09:00">
	
		    Apr 05, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/IntelliJ/">IntelliJ</a>


    
</div>

            </div>
            
                <div class="postShorten-content">
                    <h2 id="IntelliJ에서-http로-테스트-하기"><a href="#IntelliJ에서-http로-테스트-하기" class="headerlink" title="IntelliJ에서 .http로 테스트 하기"></a>IntelliJ에서 <code>.http</code>로 테스트 하기</h2><p>나는 java 개발을 할 때 IntelliJ를 사용한다. 지금 다니고 있는 회사에 입사하기 전까지는 eclipse 만 사용해봤었고,<br>IntelliJ는 사실 존재 자체도 모르고 있었다. <del>그러나 지금은 intelliJ 없이는 java개발을 할 수 없는 몸이 되어버렷!! 다..</del><br>IntelliJ는 여러 편의 기능을 번들로 제공하고 있는데 그 중 하나가 지금 이야기 하고자 하는 http client 툴이다.</p>
<p>사실 IntelliJ의 Http 툴의 사용방법을 설명한 글을 이전에 블로그에 한번 작성한 적이 있었으나 안타깝게도 블로그와 함께 날려먹었고, 이 툴에 관해 잘 설명해 놓은 글은 굳이 내가 정리하지 않더라도 많이 있다. 그럼에도 불구하고 또 이 툴에 대해서 정리하는 이유는 <strong>내가 잘 보려고</strong></p>
<p>회사에서 개발 일을 하면서 많은 지식을 익히고 이 지식들로 코딩을 하지만, 돌아서고 나면 잊어버린다. 물론 코드에 작업 내용이 남아있어 다시 열어본다면 이해하고 동일한 코드를 만들 수 있지만, 사실 이 코드의 소유는 내가 아니라 회사다. 퇴사를 한다면?? 내가 동일한 코드를 만들 수 있을까? 그래서 내 것으로 만들기 위해 하나씩 정리 하려고 한다.</p>
<h2 id="http-소개"><a href="#http-소개" class="headerlink" title=".http 소개"></a><code>.http</code> 소개</h2><p>이 툴의 명칭은 HTTP Client 쯤 되는것 같다. (HTTP client in IntelliJ IDEA code editor)<br>안타깝게도 <code>ultimate</code> 딱지가 붙어 있는걸 봐서는 intelliJ 커뮤니티 에디션에서는 사용하지 못하는 듯 하다. 레퍼런스 페이지는 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jetbrains.com/help/idea/http-client-in-product-code-editor.html">#여기</a></p>
<p>간단히 말해 http 호출을 해볼 수 있는 툴이다.</p>
<h2 id="http-를-쓰는-이유"><a href="#http-를-쓰는-이유" class="headerlink" title=".http 를 쓰는 이유"></a><code>.http</code> 를 쓰는 이유</h2><p>익히지 않고 직관적으로 쓰기에는 물론 postman이 더 낫다. swagger도 많이 쓴다. 설치하기 귀찮으면 <code>curl</code>을 사용하기도 한다.<br>내가 <code>.http</code> 를 쓰는 가장 큰 이유는 </p>
<blockquote>
<ol>
<li>Git을 통한 형상 관리</li>
<li>Git으로 팀원과 쉽게 공유가 가능</li>
<li>테스트 툴이므로 초록 막대를 보며 마음의 안정을 얻을 수 있다. (또는 빨간 막대를 볼수도..)</li>
</ol>
</blockquote>
<p>뭐 이 외에도 쓰다보면 여러 장점들을 느낄 수 있겠지만, 일단 이 세가지만으로도 충분히 좋다.</p>
<h2 id="기본-사용법"><a href="#기본-사용법" class="headerlink" title="기본 사용법"></a>기본 사용법</h2><ol>
<li>intelliJ의 프로젝트 explorer에서 적당한 곳에 <code>마우스 우클릭</code> &gt; <code>NEW</code> &gt; <code>HTTP Request</code><img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image1.png" class title="설명1">

</li>
</ol>
<hr>
<ol start="2">
<li>적당한 파일명을 입력 후 엔터를 치면 <code>.http</code> 로 끝나는 파일이 생성 되고 에디터로 그 파일을 연다.</li>
</ol>
<blockquote>
<p><strong>이 때 주의할 점</strong> 파일명을 <code>status</code>로는 하지 말자. 왠지 모르겠지만, <code>status.http</code> 파일에서는 http 테스트가 활성화가 되지 않는다.</p>
</blockquote>
<img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image2.png" class title="설명2">

<ol start="3">
<li>이제부터 테스트를 만들면 된다. 아직 우리는 사용법을 잘 모르므로 Examples를 눌러보자. 그럼 친절하게 아래와 같은 내용의 파일이 열린다.</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">### GET request with a header</span><br><span class="line">GET https:&#x2F;&#x2F;httpbin.org&#x2F;ip</span><br><span class="line">Accept: application&#x2F;json</span><br><span class="line"></span><br><span class="line">### GET request with parameter</span><br><span class="line">GET https:&#x2F;&#x2F;httpbin.org&#x2F;get?show_env&#x3D;1</span><br><span class="line">Accept: application&#x2F;json</span><br><span class="line"></span><br><span class="line">### GET request with environment variables</span><br><span class="line">GET &#123;&#123;host&#125;&#125;&#x2F;get?show_env&#x3D;&#123;&#123;show_env&#125;&#125;</span><br><span class="line">Accept: application&#x2F;json</span><br><span class="line"></span><br><span class="line">### GET request with disabled redirects</span><br><span class="line"># @no-redirect</span><br><span class="line">GET http:&#x2F;&#x2F;httpbin.org&#x2F;status&#x2F;301</span><br><span class="line"></span><br><span class="line">### GET request with dynamic variables</span><br><span class="line">GET http:&#x2F;&#x2F;httpbin.org&#x2F;anything?id&#x3D;&#123;&#123;$uuid&#125;&#125;&amp;ts&#x3D;&#123;&#123;$timestamp&#125;&#125;</span><br><span class="line"></span><br><span class="line">###</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li>각 테스트는 <code>###</code>로 구분한다.</li>
<li>제일 윗줄에 <code>메소드 URL</code> 형식으로 호출하고자 하는 URL을 정의한다.</li>
<li>헤더는 URL 바로 아랫줄에 <code>키: 밸류</code> 형태로, 붙이고자 하는 헤더가 여러개일 경우 계속 줄을 이어서 써준다.</li>
<li>예제에는 안 나왔지만 requestBody를 같이 보내고자 할 경우, 헤더 밑으로 두줄 바꾸고 그 밑에 입력해주면 된다.</li>
</ol>
</blockquote>
<p>기본 사용방법은 이정도이고, <code>&#123;&#123;$uuid&#125;&#125;</code>나 <code>&#123;&#123;host&#125;&#125;</code> 같은게 보이는 것 같지만 기분탓이라 생각하고 일단 넘어가자.<br>대략 사용방법은 봤으니, 우리가 테스트 하고자 하는걸 입력 해보자.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GET https:&#x2F;&#x2F;google.com</span><br></pre></td></tr></table></figure>

<p>난 이렇게 입력 했다. 좀 편한 방법을 쓰고자 한다면 우측 상단 메뉴에 <code>Add Request</code> 를 마우스로 누르면 snippet 이 나오니 참고할 수 있다.</p>
<p>그리고 초록색 재생 화살표를 누르면 실행되고, 화면 아래에 결과가 나온다.</p>
<img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image3.png" class title="설명3">
<p><em>► 눌러눌러!!</em></p>
<img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image4.png" class title="설명4">
<p>구글 호출 했을때 나오는 결과를 볼 수가 있다.</p>
<h2 id="환경변수-설정해서-사용하기"><a href="#환경변수-설정해서-사용하기" class="headerlink" title="환경변수 설정해서 사용하기"></a>환경변수 설정해서 사용하기</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jetbrains.com/help/idea/http-client-in-product-code-editor.html#using_request_vars">자세한 설명 링크</a></p>
<p>위에 예시로 제시한 테스트 중에 <code>&#123;&#123;host&#125;&#125;</code> 같이 이중 블릿으로 감싼 아이들이 보인다. <code>.http</code> 테스트에서 환경 변수들을 사용할 수 있는데, 여러 환경에 따른 값들을 미리 설정해놓고 필요할때마다 선택해서 실행 할 수 있도록 편리한 기능을 제공해 준다.</p>
<p><code>.http</code> client는 두 종류의 변수를 사용할 수 있는데, Dynamic 변수와 직접 정의한 환경 변수이다. 다이나믹 변수는 <code>$</code>로 시작하고, 아래 세 종류가 있다.</p>
<blockquote>
<ul>
<li>$uuid: 우리가 알고있는 UUID</li>
<li>$timestamp: Unix Timestamp형태의 현재 시각</li>
<li>$randomInt: 0에서 1000 사이의 랜덤 숫자</li>
</ul>
</blockquote>
<p>그리고 우리가 알아볼 환경변수. 환경변수는 프로젝트 내에 <code>rest-client.env.json</code> (또는 <code>http-client.env.json</code>도 가능) 라는 이름의 json 파일을 생성해서 사용한다. 레퍼런스 문서에서 제공하는 예제를 살펴보자.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;development&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;host&quot;</span>: <span class="string">&quot;localhost&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;id-value&quot;</span>: <span class="number">12345</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;my-var&quot;</span>: <span class="string">&quot;my-dev-value&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;production&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;host&quot;</span>: <span class="string">&quot;example.com&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;id-value&quot;</span>: <span class="number">6789</span>,</span><br><span class="line">    <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;my-var&quot;</span>: <span class="string">&quot;my-prod-value&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이 예제에서는 development, production 환경을 사용할 수 있고, 그 내부에 정의 돼있는 <code>host</code>, <code>id-value</code> 와 같은 값들을 미리 정의 해놨다고 이해하면 된다. 테스트 할때 위 예제에서 봤듯이 <code>http://&#123;&#123;host&#125;&#125;/index.html</code> 와 같은 형식으로 사용할 수 있다. 물론 이 값들은 url 뿐만 아니라 헤더나 request body 영역에서도 치환해서 사용할 수 있다.</p>
<p>username과 password는 비어두었는데, 개인정보 등 공유되어서는 안될 민감한 정보들을 별도로 정의하기 위해서 비워두었다. <code>rest-client.private.env.json</code> (또는 <code>http-client.private.env.json</code>) 라는 파일 명으로 별도로 정의하여 사용할 수 있는데, 이는 형상관리에서 기본으로 제외되도록 설정돼있다고 한다.</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;development&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;dev-user&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;dev-password&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">&quot;production&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;username&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;password&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>rest-client.env.json</code> 와 같이 이런 형태로 정의 해서 사용할 수 있다.</p>
<h2 id="테스트-결과값-받아서-사용하기"><a href="#테스트-결과값-받아서-사용하기" class="headerlink" title="테스트 결과값 받아서 사용하기"></a>테스트 결과값 받아서 사용하기</h2><p>이렇게 환경변수를 설정하는 방법은 <code>rest-client.env.json</code> 파일을 통해 미리 정의하는 방법 말고 또 한가지가 존재한다. 바로 http 호출 후 response handler를 정의해서 변수로 설정하는 방법이다. 아래 예제를 살펴보자. (참고로 response handler는 javascript 문법을 사용한다. 또한 자동완성까지 지원한다. ㄴㅇㄱ)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">POST http:&#x2F;&#x2F;localhost&#x2F;oauth&#x2F;token</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type&#x3D;client_credentials&amp;scope&#x3D;read_profile</span><br><span class="line"></span><br><span class="line">&gt; &#123;% &#x2F;&#x2F;response handler</span><br><span class="line">client.global.set(&quot;access_token&quot;, response.body.access_token);</span><br><span class="line">client.log(client.global.get(&quot;access_token&quot;));</span><br><span class="line">%&#125;</span><br></pre></td></tr></table></figure>

<p>POST로 <code>http://localhost/oauth/token</code>를 호출하고 받는 response에서 response.body 의 access_token 값을 받아 client.global.set()이라는 함수로 변수 설정이 가능한데, 이 스크립트의 경우 “access_token”이라는 변수에 response.body 객체의 access_token 값을 할당 했다. (response.body 가 json형태일 경우다)</p>
<p>response 객체는 body 말고도 다른 속성들도 제공 해준다. 에디터에서 <code>response.</code>을 찍어서 우리의 친절한 intelliJ 자동완성의 도움을 받아 살펴보자.</p>
<img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image5.png" class title="설명5">

<p><code>body</code> 외에 <code>contentType</code>, <code>headers</code>, <code>status</code> 값들을 제공한다.</p>
<p>이를 잘 활용하면 ouath 토큰을 발급받아서 환경변수에 넣는 스크립트를 만들고, 그 이후에 실행하는 스크립트에서 발급받은 토큰을 포함하여 request 테스트를 하는 등의 케이스에서 활용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">### Get Token</span><br><span class="line">POST http:&#x2F;&#x2F;localhost&#x2F;oauth&#x2F;token</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">grant_type&#x3D;client_credentials&amp;scope&#x3D;read_profile</span><br><span class="line"></span><br><span class="line">&gt; &#123;% &#x2F;&#x2F;response handler</span><br><span class="line">client.global.set(&quot;access_token&quot;, response.body.access_token);</span><br><span class="line">client.log(client.global.get(&quot;access_token&quot;));</span><br><span class="line">%&#125;</span><br><span class="line"></span><br><span class="line">###</span><br><span class="line"></span><br><span class="line">GET http:&#x2F;&#x2F;localhost&#x2F;data</span><br><span class="line">Authorization: bearer &#123;&#123;access_token&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>response handler는 이렇게 테스트 스크립트 내에 inline으로 작성하지만 별도의 js 파일로 만들어서 include 하는 방법도 존재한다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET host&#x2F;api&#x2F;test</span><br><span class="line"></span><br><span class="line">&gt; scripts&#x2F;my-script.js</span><br></pre></td></tr></table></figure>

<h2 id="초록-막대-초록-막대를-보자"><a href="#초록-막대-초록-막대를-보자" class="headerlink" title="초록 막대. 초록 막대를 보자!!"></a>초록 막대. 초록 막대를 보자!!</h2><p>거의 다 와 간다. 글 머리에 초록 막대를 볼 수 있다고 적어 놓았는데, 이제 초록 막대를 보는 방법, 즉 테스트 케이스 답게 스크립트로 만드는 방법을 알아보자.</p>
<p>간단하게는 아래와 같은 방법으로 사용할 수 있다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">GET https:&#x2F;&#x2F;httpbin.org&#x2F;status&#x2F;200</span><br><span class="line"></span><br><span class="line">&gt; &#123;%</span><br><span class="line">    client.test(&quot;Request executed successfully&quot;, function() &#123;</span><br><span class="line">        client.assert(response.status &#x3D;&#x3D;&#x3D; 200, &quot;Response status is not 200&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">%&#125;</span><br></pre></td></tr></table></figure>

<p><code>client.assert</code>만으로도 잘 작동하기는 하나, 제대로 된 테스트 케이스는 테스트 정의가 잘 돼 있어야 하므로 <code>client.test</code>로 테스트 케이스가 작동하는 상황에 대해서 설명한 후 두번째 파라미터 함수로 실제 수행되는 테스트 코드를 넣어주면 된다.</p>
<p><code>client.assert</code>는 첫번째 파라미터에 테스트 하고자 하는 수식, 두번째 파라미터로 테스트가 실패할 경우 표시될 메세지를 넣어준다.</p>
<p>이제 ►를 눌러 실행해보자.</p>
<img src="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/image6.png" class title="설명6">

<p>이제 마음의 평안을 얻을 수 있다. <code>response.status</code> 뿐만 아니라 body에서 어떤 결과를 받아왔는지 등으로도 테스트 케이스를 만들 수 있으니 잘 활용하면 좋다.</p>
<p>intelliJ에서 http로 테스트하기 끗!!</p>

                    
                        


                    
                    
                        <p>
                            <a href="/20200405/IntelliJ%EC%97%90%EC%84%9C-http%EB%A1%9C-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/#post-footer" class="postShorten-excerpt_link link" aria-label>
                                Comment and share
                            </a>
                        </p>
                    
                </div>
            
        </div>
        
    </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        
        <li class="pagination-number">page 1 of 1</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 shockshot@naver.com. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">shockshot@naver.com</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover2.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-ofs4ykkzhow0axhilcw7ijqajqncd242ivjtsphmyhqoivownzrn8dpzz1yu.min.js"></script>

<!--SCRIPTS END-->





    </body>
</html>
